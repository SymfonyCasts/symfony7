# Creating JSON API Endpoints

Coming Soon...

If you want to build an API, you can absolutely do that with Symfony. In fact, it's a fantastic option in part because of API Platform, a framework for building APIs built on top of Symfony that both makes it fast to build an API and creates an API that is more robust than you could ever imagine. However, it's also simple enough to return JSON from a controller. I want to try to return some ship data as JSON. So over in our project, in mainController, we could just create another method for this. But for organization purposes, let's create a totally new controller class. I'll go to NewPHPClass and call it StarshipAPIController. Because I went to NewPHPClass, it creates the class and even the namespace for me. Now going forward, every time I create a controller, I'm going to immediately extend abstractController because there's no downside and it's going to give us some nice shortcuts. For the method, let's call it public function getCollection because this is going to return a collection of starships. And you don't have to, but if you want, you can add the response return type. For the route, we will do route, select the one from attribute and hit tab. So I used auto-completion there to add the use statement for abstractController, route, and response. So make sure you have all of those. For the URL in this case, how about slash API slash starships. Inside of here, I'm going to paste in a variable starships, which is set to an array of three associate arrays of starships. So you can imagine what that's going to look like in JSON. How do we turn that into JSON? Well, it can be this simple, return new response, and then JSON underscore encode starships. But actually we can do even better than that. I'm going to undo that. Instead, I'm going to say return this arrow, JSON starships. And when we try, we move over and go to slash API slash starships. Got it. Dang, that was easy. And if you're wondering why it's styled like this, that's not a symphony thing. I just have a Chrome extension installed to prettify JSON. Okay. Now in the real world, when we start querying the database, we're going to be working with objects instead of associative arrays.  Now we won't add a database in this tutorial, but we can still start using objects for our data to make things more realistic. In the source directory, create a new sub directory called model. Now what we're about to do has absolutely nothing to do with symphony. Instead, I'm looking at this array here and thinking, you know what? Instead of passing around an associative array with name, class, captain, and status keys on it, I'd rather create a starship class and pass around objects. So entirely on my own, independent of symphony, I've decided to create a model directory, which is a pretty good name for what we're about to do, and inside a new class called starship. And because this is just a class for us, we can make it look however we want. It doesn't need to extend anything. I'm going to create a public function, underscore construct with five properties, a private int ID, and then four more properties for each of the four keys that we have in our array. Private string name, private string class, private string captain, and private string status. Perfect. And actually you can see my editor is highlighting because I have PHP code fixer installed, it's highlighting a code problem here, and I can actually click this to fix it, or I can go right here and hit alt enter to bring that up, and I fixed that, and it fixed my code styling, which is nice. If you're not familiar with this constructor syntax, this creates a constructor with five arguments, but it also creates five properties and populates those properties with whatever we pass here. Now the only problem right now is that we can create this object, but there's no way to read this data off because I created private properties. So to allow me to read data off, I'm going to create getter methods, but I'm not going to do this by hand. Instead, go to code generate or command N on a Mac and go to getters, and I'll select all of them. And now five get methods, get ID, get name, and the others. All right, in our controller, let's convert these arrays to objects. So new starship, I'll hit tab, so it has the you statement.  Then I'll give us an ID of one, and then we'll just transfer the other keys, name, class, captain, and finally status. And just like that, we have our first object, and that looks and feels much nicer to me. Now that we've done that once, I'll highlight the other two arrays, and I'm just going to paste in those two objects to save us some time. So an array of three starship objects, and we're passing that to this arrow JSON. Is that still going to work? Totally not. We get an array of three empty objects. That's because this arrow JSON is using JSON underscore encode internally, and JSON encode can't handle classes with private properties. What we need is something smarter, something that can recognize that even though this name property is private, we have a get name method down here, and it should be able to call that to get the name property. So what can we use? Well, remember how symphony is actually a huge set of components that solve into individual problems? Well, there's one of those components is called serializer, and its whole job is to take objects and serialize them to JSON, or take JSON and deserialize back into objects. And it can totally handle situations where you have a private properties with public getter methods. So let's get it installed. Composer require serializer. And once again, yes, this is an alias and it's an alias to a pack. The pack's going to install symphony serializer as well as a few other packages to make it work in a really robust way. Now without doing anything else, go back, refresh, and it works. How? Well, this JSON method is smart. I'm going to hold command or control to jump into it. It detects if the serializer system is available. And if it is, it uses that to transform the object into JSON. And since that system is smart, it has no problems doing it. But what do I mean by that system? And what is the serializer thing in this container thing? Or what if we needed to transform an object to JSON somewhere other than our controller where we don't have access to the JSON shortcut? How could we do that? It's time to learn about the most important concept in symphony, services.
